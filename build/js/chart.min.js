"use strict";function CalValues(){this.instance=""}function Parsing(){this.instance="",this.input="",this.index=0,this.pdts=[],this.pdtsIns=[]}function findRangeModified(t){var a,e,i,s,n,r=0;for(jsonData.minYTickValue===!0&&"undefined"!=typeof t&&(r=t.min,i=r%10,i<0&&(i=10+i),r-=i,a=t.max),a=maximum,i=a%10,i<0&&(i=10-i),0!==i&&(a+=10-i),diffBwTips=a-r,e=diffBwTips/10,s=0;;){if(!(Math.pow(10,s)<e)){s--;break}s++}e<10?s=1:e<1&&(s=0),n=a%Math.pow(10,s),maximum=0!==n?a+(Math.pow(10,s)-n):a,diffBwTips=maximum-r,findYTipsModified(s)}function findYTipsModified(t){var a,e,i=diffBwTips;for(a=0;a<10;a++){if(e=0,i/5%Math.pow(10,t)===0){noOfYTips=5,e=1;break}if(i/3%Math.pow(10,t)===0){noOfYTips=3,e=1;break}if(i/4%Math.pow(10,t)===0){noOfYTips=4,e=1;break}if(i/6%Math.pow(10,t)===0){noOfYTips=6,e=1;break}if(i/7%Math.pow(10,t)===0){noOfYTips=7,e=1;break}i+=Math.pow(10,t)}maximum+=i-diffBwTips,diffBwTips=i}function ParsingData(){this.instance=""}function Axis(t,a,e,i,s){this.instance=t,this.x1=a,this.y1=e,this.inclinationAxis=i,this.svg=s,PlotGraph.call(this)}function parseData(t){var a,e,i,s,n,r,o=[];if(a=t.chartType,"CrossTab"==a){for(e=new Parsing,i=e.setValues(t),s=i.length,findRangeModified(),n=new CrossTab,n.addHeader(),r=0;r<s;r++)drawChart[r]=new CrossTab(i[r],t,r,s),drawChart[r].initiateDraw();n.addFooter()}else{var h,l,c,d,p=new CalValues;if(p.calculateChartOutLines(t),"false"==t.chart_map)p.setZone();else switch(p.setKeys(),l=new CalValues,l.customChartArrange(),c=jsonData.chart_order_func){case"minimum":arrangeOnMin();break;case"maximum":arrangeOnMax()}for(d=jsonData.y_axis_map.length,r=0;r<d;r++){var u=jsonData.y_axis_map[r];o=[],"false"==t.chart_map?(o[r]=new ParsingData,h=o[r].setChartValues(u,r)):(o[r]=new CalValues,h=o[r].setChartValues(u,r)),o[r]=new DrawChart(h,r),o[r].initiateGraph()}}}function DrawChart(t,a){this.instance=t,this.index=a}function DrawXAxis(t,a,e,i,s){Axis.call(this,t,a,e,i,s),this.instance=t,this.x1=a,this.y1=e}function DrawYAxis(t,a,e,i,s){Axis.call(this,t,a,e,i,s),this.instance=t,this.x1=a,this.y1=e}function PlotGraph(t){this.instance=t}function CustomArrange(){}function arrangeOnMax(){var t,a,e,i,s,n,r=[],o=range2;for(a=jsonData.y_axis_map.length,t=0;t<a;t++)r.push(o[t].max);for(a=r.length,t=0;t<a-1;t++){for(i=t,e=t+1;e<a;e++)r[e]>r[i]&&(i=e);i!=t&&(s=jsonData.y_axis_map[t],n=r[t],jsonData.y_axis_map[t]=jsonData.y_axis_map[i],r[t]=r[i],jsonData.y_axis_map[i]=s,r[i]=n)}}function arrangeOnMin(){var t,a,e,i,s,n,r,o=[];for(r=range2,a=jsonData.y_axis_map.length,t=0;t<a;t++)o.push(r[t].min);for(a=o.length,t=0;t<a-1;t++){for(e=t,i=t+1;i<a;i++)o[i]<o[e]&&(e=i);e!=t&&(s=jsonData.y_axis_map[t],n=o[t],jsonData.y_axis_map[t]=jsonData.y_axis_map[e],o[t]=o[e],jsonData.y_axis_map[e]=s,o[e]=n)}}function ChartModel(){this.chartType="",this.min=0,this.max=0,this.range=0,this.maxTipValue=0,this.minTipValue=0,this.diffBwTips=0,this.noOfYTips=0,this.noofXTips=0,this.chartId="",this.chartNo=0,this.upLimitXAxis=0,this.lowLimitXAxis=0,this.upLimitYAxis=0,this.lowLimitYAxis=0,this.storeValue=[],this.storeAncorPointsX=[],this.storeAncorPointsY=[],this.tempMap="",this.lastPlottedPointX=0,this.lastPlottedPointY=0,this.textLabelId="",this.changeFactorMin=0,this.changeFactorMax=0,this.mulTiplyFactor=1,this.crossHairLineIns="",this.chartLowBoundXCoor=0,this.chartUpBoundXCoor=0,this.toolTipTextIns="",this.toolTipBoxIns="",this.yShift=0,this.selectRectIns="",this.svg="",this.numberOfColCharts=0,this.numberOfCharts=0}function ProductType(){this.model="",this.productTypes=[],this.productIns=[],this.sos=[],this.sop=[],this.sosTotal=0,this.sopTotal=0,this.productName=[],this.zoneName=""}function CrossTab(t,a,e,i){PlotColumnBar.call(this,t),this.instance=t,this.input=a,this.index=e,this.svg=[],this.chartId="",this.chartLowBoundXCoor=0,this.chartUpBoundXCoor=0,this.ChartIndex=0,this.noofXTips=0,this.sepSVG="",this.productLen=i}function ColumnChart(t){this.instance=t}function releaseColRect(t){var a=this.selectRectIns;a.setAttributeNS(null,"height",0),a.setAttributeNS(null,"width",0),flag=0}function dragColRect(t){if(1==flag){var a,e,i,s,n,r=this.selectRectIns,o=t.clientX%jsonData.chart.width-10,h=t.pageY%jsonData.chart.height-heightEachChart*chartModel[0].yShift-47,l=r.getAttribute("x"),c=r.getAttribute("y"),d=Math.abs(o-l),p=Math.abs(c-h);for(flagRemoveColor=1,r.setAttributeNS(null,"width",d),r.setAttributeNS(null,"height",p),n=document.getElementsByClassName("plotColumnGraph"),e=n.length,a=0;a<e;a++)i=Math.floor(n[a].getAttribute("x")),i+=widthEachChart*jsonData.scaleColChartFactor/100,s=Math.floor(n[a].getAttribute("y")),i<=o&&i>=l&&s<=h&&s>=c&&(n[a].style.fill="red",n[a].style.stroke="red")}}function instantiateDragCol(t){if(1!==flagRemoveColor){var a=t.clientX%jsonData.chart.width-10,e=t.pageY%jsonData.chart.height-heightEachChart*chartModel[0].yShift-47,i=this.selectRectIns;i.setAttributeNS(null,"x",a),i.setAttributeNS(null,"y",e),i.setAttributeNS(null,"height",1),i.setAttributeNS(null,"width",1),i.setAttribute("class","selectRect"),i.setAttribute("style","fill:transparent;stroke:rgb(0,0,0)"),flag=1}else{var s,n=document.getElementsByClassName("plotColumnGraph"),r=n.length;for(s=0;s<r;s++)n[s].style.fill="rgb(30, 122, 205)",n[s].style.stroke="rgb(30, 122, 205)";flagRemoveColor=0}}function columnTrigger(t){var a,e,i,s,n,r,o,h,l,c,d,p,u,f,m,g=t.detail.x%jsonData.chart.width,w=-1;for(g-=8,a=jsonData.scaleColChartFactor/100*widthEachChart,e=a;e>0;e--)storeAncorPointsX.indexOf(g+e),f=storeAncorPointsX.indexOf(g+e),m=storeAncorPointsX.indexOf(g-e),f===-1&&m===-1||(f!==-1&&(w=storeAncorPointsX.indexOf(g+e),g+=e),m!==-1&&(w=storeAncorPointsX.indexOf(g-e),g-=e));if(i=chartModel,s=0,h=jsonData.scaleColChartFactor,w!==-1){for(n=document.getElementsByClassName("plotColumnGraph"),r=n.length,e=0;e<r;e++)o=Math.floor(n[e].getAttribute("x")),o+=widthEachChart*h/100,o==g&&(n[e].style.fill="red",n[e].style.stroke="red");for(r=jsonData.y_axis_map.length,e=0;e<r;e++)if("undefined"!=typeof i[e].storeAncorPointsY[w]){s=i[e].storeValue[w],l=i[e].storeAncorPointsY[w];var C="rotate(0 "+g+","+l+")";c=i[e].toolTipTextIns,d=i[e].toolTipBoxIns,p=g+widthEachChart*shiftXTipLine,u=l-.1*heightEachChart,d.setAttributeNS(null,"x",p),d.setAttributeNS(null,"y",u),d.setAttributeNS(null,"height",.1*heightEachChart),d.setAttributeNS(null,"width",.25*widthEachChart),d.setAttribute("class","toolTipRect"),d.setAttribute("style","stroke:rgb(157, 119, 106);fill:rgb(255, 217, 204)"),i[e].svg.appendChild(d),d.setAttribute("visibility","visible"),l-=.05*heightEachChart,c.setAttribute("x",g+.05*widthEachChart),c.setAttribute("y",l),c.innerHTML=s;var x=.05*heightEachChart;c.setAttribute("font-size",x),c.setAttribute("transform",C),c.setAttribute("style","rgb(197, 159, 146)"),i[e].svg.appendChild(c),c.setAttribute("visibility","visible")}}}function removeToolTip(t){var a,e,i,s=chartModel,n=document.getElementsByClassName("plotColumnGraph"),r=n.length;if(1!==flagRemoveColor)for(a=0;a<r;a++)n[a].style.fill="rgb(30, 122, 205)",n[a].style.stroke="rgb(30, 122, 205)";for(r=s.length,a=0;a<r;a++)e=s[a].toolTipBoxIns,e.setAttribute("visibility","hidden"),i=s[a].toolTipTextIns,i.setAttribute("visibility","hidden")}function ChartFunc(t){this.instance=t}function GenColor(){}function entercoordinates(t,a){for(var e=document.getElementsByClassName(t),i=new CustomEvent("syncCrossHair",{detail:{x:a.clientX,y:a.clientY,ins:this}}),s=0;s<e.length;s++)e[s]!=a.target&&e[s].dispatchEvent(i)}function PlotColumnBar(t,a){this.instance=t}function CrossHair(t){this.instance=t}function displayCrossHair(t){var a,e,i,s=t.detail.x%jsonData.chart.width;for(s-=8,i=document.getElementsByClassName("drawCrossHairLines"),e=i.length,a=0;a<e;a++)i[a].setAttribute("visibility","visible"),i[a].setAttribute("x1",s),i[a].setAttribute("x2",s)}function removeCrossHair(t){var a,e=document.getElementsByClassName("drawCrossHairLines"),i=e.length;for(a=0;a<i;a++)e[a].setAttribute("visibility","hidden")}function LineChart(t){this.instance=t}function instantiateDragLine(t){if(1!==flagRemoveColor){var a=t.clientX%jsonData.chart.width-10,e=t.pageY%jsonData.chart.height-heightEachChart*chartModel[0].yShift-49,i=this.selectRectIns;i.setAttributeNS(null,"x",a),i.setAttributeNS(null,"y",e),i.setAttributeNS(null,"height",1),i.setAttributeNS(null,"width",1),i.setAttribute("class","selectRect"),i.setAttribute("style","fill:transparent;stroke:rgb(0,0,0)"),flag=1}else{for(var s=document.getElementsByClassName("ancorTipCicle"),n=0;n<s.length;n++)s[n].style.fill="white",s[n].style.stroke="rgb(30, 122, 205)";flagRemoveColor=0}}function dragLineRect(t){if(1==flag){var a,e,i,s,n,r,o=this.selectRectIns,h=t.clientX%jsonData.chart.width-10,l=t.pageY%jsonData.chart.height-heightEachChart*chartModel[0].yShift-49,c=o.getAttribute("x"),d=o.getAttribute("y"),p=Math.abs(h-c),u=Math.abs(d-l),f=jsonData.scaleColChartFactor/100;for(flagRemoveColor=1,o.setAttributeNS(null,"width",p),o.setAttributeNS(null,"height",u),i=document.getElementsByClassName("ancorTipCicle"),e=i.length,a=0;a<e;a++)s=Math.floor(i[a].getAttribute("cx")),r=i[a].getAttribute("r"),s+=widthEachChart*f,n=Math.floor(i[a].getAttribute("cy")),s<=h&&s>=c&&n<=l&&n>=d&&(i[a].style.fill="red",i[a].style.stroke="red")}}function releaseLineRect(t){var a=this.selectRectIns;a.setAttributeNS(null,"height",0),a.setAttributeNS(null,"width",0),flag=0}function outLineRect(t){var a=this.selectRectIns;a.setAttributeNS(null,"height",0),a.setAttributeNS(null,"width",0),flag=0}function showCoords(t){var a,e,i,s,n,r,o,h,l,c,d=t.detail.x%jsonData.chart.width,p=-1;for(d-=8,a=5;a>0;a--)e=storeAncorPointsX.indexOf(d+a),i=storeAncorPointsX.indexOf(d-a),e===-1&&i===-1||(e!==-1&&(p=e,d+=a),i!==-1&&(p=i,d-=a));if(s=chartModel,p!==-1){for(l=document.createElementNS("http://www.w3.org/2000/svg","text"),n=s.length,a=0;a<n;a++)if("undefined"!=typeof s[a].storeAncorPointsY[p]){r=s[a].storeValue[p],o=s[a].storeAncorPointsY[p];var u="rotate(0 "+d+","+o+")";c="toolTipText",l=s[a].toolTipTextIns,h=s[a].toolTipBoxIns,h.setAttributeNS(null,"x",d+widthEachChart*shiftXTipLine),h.setAttributeNS(null,"y",o-.1*heightEachChart),h.setAttributeNS(null,"height",.1*heightEachChart),h.setAttributeNS(null,"width",.25*widthEachChart),h.setAttribute("class","toolTipRect"),h.setAttribute("style","stroke:rgb(157, 119, 106);fill:rgb(255, 217, 204)"),s[a].svg.appendChild(h),h.setAttribute("visibility","visible"),o-=.05*heightEachChart,l.setAttribute("x",d+.05*widthEachChart),l.setAttribute("y",o),l.innerHTML=r;var f=.05*heightEachChart;l.setAttribute("font-size",f),l.setAttribute("transform",u),l.setAttribute("style","rgb(197, 159, 146)"),s[a].svg.appendChild(l),l.setAttribute("visibility","visible")}}else for(n=s.length,a=0;a<n;a++)h=s[a].toolTipBoxIns,h.setAttribute("visibility","hidden"),l=s[a].toolTipTextIns,l.setAttribute("visibility","hidden")}function clearcoor(t){var a,e,i,s,n=chartModel;for(e=n.length,a=0;a<e;a++)i=n[a].toolTipBoxIns,i.setAttribute("visibility","hidden"),s=n[a].toolTipTextIns,s.setAttribute("visibility","hidden")}var jsonData={},widthEachChart=0,heightEachChart=0;CalValues.prototype.findYTipsModified=function(t){var a,e,i=this.instance,s=i.minTipValue,n=i.maxTipValue,r=i.diffBwTips,o=i.mulTiplyFactor;for(a=0;a<10;a++){if(e=0,r/5%Math.pow(10,t)===0){i.noOfYTips=5,e=1;break}if(r/3%Math.pow(10,t)===0){i.noOfYTips=3,e=1;break}if(r/4%Math.pow(10,t)===0){i.noOfYTips=4,e=1;break}if(r/6%Math.pow(10,t)===0){i.noOfYTips=6,e=1;break}if(r/7%Math.pow(10,t)===0){i.noOfYTips=7,e=1;break}r+=Math.pow(10,t)}i.maxTipValue=(n+(r-i.diffBwTips))/o,i.diffBwTips=r/o,i.minTipValue=s/o},CalValues.prototype.findRangeModified=function(){var t,a,e,i,s,n=this.instance,r=n.min,o=r%10,h=n.max,l=n.changeFactorMax;for(o<0&&(o=10+o),r-=o,o=h%10,o<0&&(o=10-o),0!==o&&(h+=(10-o)*Math.pow(-1,l)),t=h-r,a=t/10,e=0;;){if(!(Math.pow(10,e)<a)){e--;break}e++}a<10?e=1:a<1&&(e=0),i=r%Math.pow(10,e),n.minTipValue=r-i*Math.pow(-1,n.changeFactorMin),s=h%Math.pow(10,e),0!==s?n.maxTipValue=h+(Math.pow(10,e)-s)*Math.pow(-1,n.changeFactorMax):n.maxTipValue=h,n.diffBwTips=n.maxTipValue-n.minTipValue,this.findYTipsModified(e)},CalValues.prototype.checkingForNegative=function(){var t=this.instance;t.min<0&&t.changeFactorMin++,t.max<0&&t.changeFactorMax++},CalValues.prototype.positionValues=function(){var t=this.instance,a=t.min,e=t.max;e-a<.1?(t.mulTiplyFactor=1e4,this.scaleValues()):e-a<=2?(t.mulTiplyFactor=100,this.scaleValues()):e-a<10?(t.mulTiplyFactor=10,this.scaleValues()):this.scaleValues()},CalValues.prototype.scaleValues=function(){var t=this.instance;t.min=t.min*t.mulTiplyFactor,t.max=t.max*t.mulTiplyFactor,this.checkingForNegative(),1==t.changeFactorMin?t.min=Math.ceil(t.min):t.min=Math.floor(t.min),1==t.changeFactorMax?t.max=Math.floor(t.max):t.max=Math.ceil(t.max)},CalValues.prototype.findMax=function(t){var a,e=jsonData.data[0][t];if("undefined"==typeof e)for(a=0;;)if(a++,e=jsonData.data[a][t],"undefined"!=typeof e)break;for(a=0;a<jsonData.data.length;a++)jsonData.data[a][t]>e&&(e=jsonData.data[a][t]);return e},CalValues.prototype.findMonth=function(t){var a=jsonData.chart_map,e=jsonData.data[t][a],i=new Date(e);return"Invalid Date"===i.toString()?(jsonData.month[t]=jsonData.data[t][a],t):i.getMonth()},CalValues.prototype.setZone=function(){var t,a;for(a=0;a<jsonData.data.length;a++)t=jsonData.data[a].zone,jsonData.y_axis_map.indexOf(t)<0&&jsonData.y_axis_map.push(t);jsonData.y_axis_map.sort()},CalValues.prototype.setKeys=function(){var t,a,e,i=jsonData.data.length,s=[];if(jsonData.y_axis_map.length<1){for(t=0;t<i;t++)s[t]=Object.keys(jsonData.data[t]);for(t=0;t<i;t++)for(a=0;a<s[t].length-1;a++)e=s[t][a],jsonData.y_axis_map.indexOf(e)<0&&jsonData.y_axis_map.push(s[t][a])}},CalValues.prototype.calculateChartOutLines=function(t){var a=window.innerWidth,e=(window.innerHeight,t.chart.width);t.chart.height;jsonData=t,widthEachChart=jsonData.chart.width-.5*jsonData.chart.width,heightEachChart=.65*jsonData.chart.height,numberOfColCharts=Math.floor(a/e)},CalValues.prototype.SetDataValueCrossTab=function(t){var a,e=this.instance,i=jsonData.data[0][t],s=0;if("undefined"==typeof i)for(;;)if(s++,i=jsonData.data[s][t],"undefined"!=typeof i)break;for(e.tempMap=t,s=0;s<jsonData.data.length;s++)a=this.findMonth(s),e.storeValue[a]=jsonData.data[s][t],jsonData.data[s][t]<i&&(i=jsonData.data[s][t]);return i},CalValues.prototype.findMinAndSetDataValue=function(t){var a,e,i=this.instance,s=jsonData.data[0][t];if("undefined"==typeof s)for(e=0;;)if(e++,s=jsonData.data[e][t],"undefined"!=typeof s)break;for(i.tempMap=t,e=0;e<jsonData.data.length;e++)a=this.findMonth(e),i.storeValue[a]=jsonData.data[e][t],jsonData.data[e][t]<s&&(s=jsonData.data[e][t]);return s},CalValues.prototype.setChartValues=function(t,a){return chartModel[a]=new ChartModel,this.instance=chartModel[a],chartModel[a].min=this.findMinAndSetDataValue(t),chartModel[a].max=this.findMax(t),this.positionValues(),this.findRangeModified(),this.instance},CalValues.prototype.customChartArrange=function(){var t;for(t=0;t<jsonData.y_axis_map.length;t++){var a=jsonData.y_axis_map[t];range2[t]=new ChartModel,this.instance=range2[t],range2[t].min=this.findMinAndSetDataValue(a),range2[t].max=this.findMax(a,t)}};var numberOfColCharts=0,chartModel=[],range2=[];Parsing.prototype.setZoneAndProduct=function(){var t,a,e=[];for(a=0;a<jsonData.data.length;a++)t=jsonData.data[a].zone,jsonData.y_axis_map.indexOf(t)<0&&jsonData.y_axis_map.push(t),t=jsonData.data[a].product,e.indexOf(t)<0&&(e.push(t),this.pdts=e);jsonData.y_axis_map.sort(),this.pdts.sort()},Parsing.prototype.setProductTypes=function(){var t,a,e,i,s,n,r;for(r=0;r<jsonData.data.length;r++)t=this.pdts.indexOf(jsonData.data[r].product),a=jsonData.y_axis_map.indexOf(jsonData.data[r].zone),n=jsonData.data[r].productType,this.pdtsIns[t].productTypes.indexOf(n)<0&&this.pdtsIns[t].productTypes.push(n),e=jsonData.data[r].sos,i=jsonData.data[r].sop,s=this.pdtsIns[t].productTypes.indexOf(n),this.pdtsIns[t].productIns[a].sos[s]=e,this.pdtsIns[t].productIns[a].sop[s]=i,e>maximum&&(maximum=e)},Parsing.prototype.setValues=function(t){jsonData=t;var a,e,i,s=[];for(this.setZoneAndProduct(),a=this.pdts.length,i=0;i<a;i++){this.pdtsIns[i]=new ProductType,e=this.pdtsIns[i],e.model=this.pdts[i],s[i]=e;for(var n=0;n<jsonData.y_axis_map.length;n++)e.productIns[n]=new ProductType}return this.setProductTypes(),s};var jsonData={},maximum=0,diffBwTips=0,noOfYTips=0,jsonData={},widthEachChart=0,heightEachChart=0;ParsingData.prototype.findYTipsModified=function(t){var a=this.instance,e=(a.minTipValue,a.maxTipValue,a.diffBwTips);for(i=0;i<10;i++){var s=0;if(e/5%Math.pow(10,t)==0){a.noOfYTips=5,s=1;break}if(e/3%Math.pow(10,t)==0){a.noOfYTips=3,s=1;break}if(e/4%Math.pow(10,t)==0){a.noOfYTips=4,s=1;break}if(e/6%Math.pow(10,t)==0){a.noOfYTips=6,s=1;break}if(e/7%Math.pow(10,t)==0){a.noOfYTips=7,s=1;break}e+=Math.pow(10,t)}a.maxTipValue=(a.maxTipValue+(e-a.diffBwTips))/a.mulTiplyFactor,a.diffBwTips=e/a.mulTiplyFactor,a.minTipValue=a.minTipValue/a.mulTiplyFactor},ParsingData.prototype.findRangeModified=function(){var t=this.instance,a=t.min,e=a%10;e<0&&(e=10+e),a-=e;var i=t.max,e=i%10;e<0&&(e=10-e),0!==e&&(i+=(10-e)*Math.pow(-1,t.changeFactorMax));for(var s=i-a,n=s/10,r=0;;){if(!(Math.pow(10,r)<n)){r--;break}r++}n<10?r=1:n<1&&(r=0);var o=a%Math.pow(10,r);t.minTipValue=a-o*Math.pow(-1,t.changeFactorMin);var h=i%Math.pow(10,r);0!==h?t.maxTipValue=i+(Math.pow(10,r)-h)*Math.pow(-1,t.changeFactorMax):t.maxTipValue=i,t.diffBwTips=t.maxTipValue-t.minTipValue,this.findYTipsModified(r)},ParsingData.prototype.checkingForNegative=function(){var t=this.instance;t.min<0&&t.changeFactorMin++,t.max<0&&t.changeFactorMax++},ParsingData.prototype.positionValues=function(){var t=this.instance,a=t.min,e=t.max;e-a<.1?(t.mulTiplyFactor=1e4,this.scaleValues()):e-a<=2?(t.mulTiplyFactor=100,this.scaleValues()):e-a<10?(t.mulTiplyFactor=10,this.scaleValues()):this.scaleValues()},ParsingData.prototype.scaleValues=function(){var t=this.instance;t.min=t.min*t.mulTiplyFactor,t.max=t.max*t.mulTiplyFactor,this.checkingForNegative(),1==t.changeFactorMin?t.min=Math.ceil(t.min):t.min=Math.floor(t.min),1==t.changeFactorMax?t.max=Math.floor(t.max):t.max=Math.ceil(t.max)},ParsingData.prototype.findMax=function(t){for(var a=0,e=0,i=jsonData.productChoose,e=0;e<jsonData.data.length;e++)jsonData.data[e].product==i&&jsonData.data[e].zone==t&&jsonData.data[e].sos>a&&(a=jsonData.data[e].sos);return a},ParsingData.prototype.findMonth=function(t){var a=jsonData.chart_map,e=jsonData.data[t][a];return dateObject=new Date(e),"Invalid Date"===dateObject.toString()?(jsonData.month[t]=jsonData.data[t][a],t):dateObject.getMonth()},ParsingData.prototype.setZone=function(){for(var t,a=0;a<jsonData.data.length;a++)t=jsonData.data[a].zone,jsonData.y_axis_map.indexOf(t)<0&&jsonData.y_axis_map.push(t);jsonData.y_axis_map.sort()},ParsingData.prototype.setKeys=function(){var t=jsonData.data.length;if(jsonData.y_axis_map.length<1){for(var a=[],e=0;e<t;e++)a[e]=Object.keys(jsonData.data[e]);for(var e=0;e<t;e++)for(var i=0;i<a[e].length-1;i++){var s=a[e][i];jsonData.y_axis_map.indexOf(s)<0&&jsonData.y_axis_map.push(a[e][i])}}},ParsingData.prototype.setXAxisTicksLabel=function(){for(var t,a=jsonData.productChoose,e=(jsonData.chartSelect,0);e<jsonData.data.length;e++)t=jsonData.data[e].productType,jsonData.data[e].product==a&&jsonData.month.indexOf(t)<0&&jsonData.month.push(t)},ParsingData.prototype.calculateChartOutLines=function(t){jsonData=t,widthEachChart=jsonData.chart.width-.5*jsonData.chart.width,heightEachChart=.65*jsonData.chart.height;var a=window.innerWidth,e=(window.innerHeight,jsonData.chart.width);jsonData.chart.height;numberOfColCharts=Math.floor(a/e)},ParsingData.prototype.findMinAndSetDataValue=function(t){var a=this.instance,e=jsonData.productChoose,i=(jsonData.chartSelect,0),s=0;a.tempMap=t;for(var s=0,n=0;s<jsonData.data.length;s++)jsonData.data[s].product==e&&jsonData.data[s].zone==t&&(a.storeValue[n]=jsonData.data[s].sos,n++);return i},ParsingData.prototype.setChartValues=function(t,a){return chartModel[a]=new ChartModel,this.instance=chartModel[a],this.setXAxisTicksLabel(),chartModel[a].min=this.findMinAndSetDataValue(t),chartModel[a].max=this.findMax(t),this.positionValues(),this.findRangeModified(),this.instance},ParsingData.prototype.customChartArrange=function(){for(var t=0;t<jsonData.y_axis_map.length;t++){var a=jsonData.y_axis_map[t];range2[t]=new ChartModel,this.instance=range2[t],range2[t].min=this.findMinAndSetDataValue(a),range2[t].max=this.findMax(a,t)}};var numberOfColCharts=0,chartModel=[],range2=[];Axis.prototype=Object.create(PlotGraph.prototype),Axis.prototype.constructor=Axis,Axis.prototype.plotAxis=function(){var t,a,e=(new PlotGraph(e),this.instance),i=this.x1,s=this.y1,n=this.inclinationAxis;"vertical"==n?(t=i,a=s+heightEachChart):"horizontal"==n&&(t=i+widthEachChart,a=s);var r="stroke:rgb(237, 237, 237);stroke-width:1;",o="axisDraw",h=this.svg;this.drawLine(h,i,s,t,a,r,o)};var drawChart=[];parseData(json),window.onresize=function(){location.reload()},DrawChart.prototype.addChartName=function(t){var a,e,i,s,n=this.instance,r=new PlotGraph(n),o=jsonData.y_axis_map[this.index],h=n.chartLowBoundXCoor,l=n.svg,c=n.lowLimitYAxis,d=n.upLimitYAxis,p=heightEachChart*chartNameBoxShift,u=n.chartUpBoundXCoor,f=n.chartLowBoundXCoor,m=heightEachChart*chartNameBoxHtFactor,g=u-f;a=2!==t?c+p:d-p-m,e="chartName";var w="fill:rgb(245,250,255);stroke:rgb(190,223,254);stroke-width:1;";i={svg:l,className:e,style:w},r.drawRectangle(h,a,m,g,i),a+=.6*m,h=(f+u)/2*.8,w="stroke:rgb(6,48,86);";var C=.1*heightEachChart;e="textAdd",s={svg:l,className:e,fontSize:C,style:w},r.addText(h,a,o,s)},DrawChart.prototype.drawChartOutline=function(){var t,a,e,i,s,n,r,o=this.instance,h=jsonData.y_axis_map.length,l=1,c=yShiftPer;o.chartId=document.getElementById("chart"),o.chartNo=this.index+1,h%2===0&&(l=2),o.yShift=c,t=2!==l?heightEachChart*c:heightEachChart*c+heightEachChart,e=widthEachChart*distYAxisFromOr,o.chartLowBoundXCoor=e,i=e+widthEachChart,o.chartUpBoundXCoor=i,s="horizontal",n=new DrawXAxis(o,e,t,s,o.svg),n.drawAxis(),n.drawXAxisComp(l,h),c=o.yShift,e=widthEachChart*distYAxisFromOr,i=widthEachChart*distYAxisFromOr,t=heightEachChart*c,a=t+heightEachChart,s="vertical",r=new DrawYAxis(o,e,t,s,o.svg),r.drawAxis(),r.drawYAxis(),this.addChartName(l)},DrawChart.prototype.initiateGraph=function(){var t,a=this.instance,e=new PlotGraph;switch(a.svg=e.createSVG(jsonData.chart.width,jsonData.chart.height),this.drawChartOutline(),t=jsonData.chartType){case"line":drawChart=new LineChart(a),drawChart.initiateDraw();break;case"column":drawChart=new ColumnChart(a),drawChart.initiateDraw()}};var storeAncorPointsX=[],flag=0,flagRemoveColor=0,shiftXTipLine=.01,shiftXTipCol=.07,distYAxisFromOr=.2,yShiftPer=.25,chartNameBoxShift=.03,chartNameBoxHtFactor=.15;DrawXAxis.prototype=Object.create(Axis.prototype),DrawXAxis.prototype.constructor=DrawXAxis,DrawXAxis.prototype.drawAxis=function(){this.plotAxis()},DrawXAxis.prototype.drawXAxisComp=function(t,a){var e,s,n,r=this.instance,o=r.chartNo,h=r.yShift,l=this.x1,c=this.y1;jsonData.data.length;if("line"==jsonData.chartType)var d=l+shiftXTipLine*widthEachChart;else if("column"==jsonData.chartType)var d=l+shiftXTipCol*widthEachChart;for(r.lowLimitXAxis=d,r.noofXTips=r.storeValue.length,n=r.noofXTips,i=0;i<n;i++){if(l=d+widthEachChart/n*i,e=d+widthEachChart/n*i,r.upLimitXAxis=l,2!==t?(c=heightEachChart*h-4,s=heightEachChart*h+4):(c=heightEachChart*h+heightEachChart-4,s=heightEachChart*h+heightEachChart+4),"line"==jsonData.chartType){var p="stroke:rgb(237, 237, 237);stroke-width:1;",u="axisTicks",f=r.svg;this.drawLine(f,l,c,e,s,p,u)}2!==t&&o<=numberOfColCharts&&this.chartDivLabelX(jsonData.month[i],l,s,t),2==t&&o>a-numberOfColCharts&&this.chartDivLabelX(jsonData.month[i],l,s,t)}},DrawYAxis.prototype=Object.create(Axis.prototype),DrawYAxis.prototype.constructor=DrawYAxis,DrawYAxis.prototype.drawAxis=function(){this.plotAxis()},DrawYAxis.prototype.drawYAxis=function(){var t,a,e,i,s,n,r=this.instance,o=this.x1,h=this.y1,l=r.svg,c=r.noOfYTips,d=h,p=o,u=r.chartLowBoundXCoor,f=r.chartUpBoundXCoor,m=u;for(r.upLimitYAxis=h,e=f-u,i=heightEachChart/c,s=0;s<c;s++){o=p-4,t=o,h=d+heightEachChart/c*s,a=d+heightEachChart/c*s;var g="stroke:rgb(237, 237, 237);stroke-width:1;",w="axisTicks";n={svg:l,x1:o,y1:h,x2:t,y2:a,className:w},this.drawLine(l,o,h,t,a,g,w),w="divLines",t=widthEachChart+widthEachChart*distYAxisFromOr,this.drawLine(l,o,h,t,a,g,w),s%2==1&&(w="designRect",g="fill:rgb(247,247,247);",l=r.svg,n={svg:l,className:w,style:g},this.drawRectangle(m,h,i,e,n))}for(r.lowLimitYAxis=h+heightEachChart/c,s=0;s<=c;s++)a=d+heightEachChart/c*s,this.chartDivLabelY(a,s)},PlotGraph.prototype.createSVG=function(t,a){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("height",a),e.setAttribute("width",t);var i=document.getElementById("chart");return e.setAttribute("class","chartSVG"),i.appendChild(e),e},PlotGraph.prototype.drawLine=function(t,a,e,i,s,n,r,o,h){var l=document.createElementNS("http://www.w3.org/2000/svg","line");l.setAttribute("x1",a),l.setAttribute("y1",e),l.setAttribute("x2",i),l.setAttribute("y2",s),l.setAttribute("class",r),l.setAttribute("stroke-dasharray",h),l.setAttribute("style",n),"undefined"!=typeof o&&l.setAttribute("visibility","hidden"),t.appendChild(l)},PlotGraph.prototype.drawRectangle=function(t,a,e,i,s){var n=document.createElementNS("http://www.w3.org/2000/svg","rect");return n.setAttributeNS(null,"x",t),n.setAttributeNS(null,"y",a),n.setAttributeNS(null,"height",e),n.setAttributeNS(null,"width",i),n.setAttribute("class",s.className),"undefined"!=typeof s.styleColor?(n.setAttribute("fill",s.styleColor),n.setAttribute("stroke",s.styleColor)):n.setAttribute("style",s.style),s.svg.appendChild(n),n},PlotGraph.prototype.plotTipCirle=function(t,a,e){var i=document.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttribute("cx",t),i.setAttribute("cy",a),i.setAttribute("r",5),i.setAttribute("class","ancorTipCicle");var s="stroke:blue; stroke-width:2;fill:white;";i.setAttribute("style",s),this.instance.svg.appendChild(i)},PlotGraph.prototype.addText=function(t,a,e,i){var s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",t),s.setAttribute("y",a),s.innerHTML=e,s.setAttribute("class",i.className),s.setAttribute("font-size",i.fontSize),s.setAttribute("transform",i.transform),s.setAttribute("style",i.style),i.svg.appendChild(s)},PlotGraph.prototype.chartDivLabelX=function(t,a,e,i){var s;a-=widthEachChart/70,e+=heightEachChart/40,2!==i&&(e-=20);var n="chartDivLabelX",r=.05*heightEachChart;s={fontSize:r,className:n,svg:this.instance.svg},this.addText(a,e,t,s)},PlotGraph.prototype.chartDivLabelY=function(t,a){var e,i=this.instance,s=widthEachChart/16;t=t;var n=.04*widthEachChart,r=i.maxTipValue-i.diffBwTips*a/i.noOfYTips;1e4==i.mulTiplyFactor?r=parseFloat(r).toFixed(3):100==i.mulTiplyFactor&&(r=parseFloat(r).toFixed(1));var o="chartDivLabelY";e={className:o,fontSize:n,svg:this.instance.svg},this.addText(s,t,r,e)},CrossTab.prototype=Object.create(PlotColumnBar.prototype),CrossTab.prototype.constructor=CrossTab,CrossTab.prototype.drawChartOutline=function(){this.chartId=document.getElementById("chart");var t,a,e,i,s,n,r,o=this.instance;t=0,this.chartLowBoundXCoor=t,a=t+heightEachChart,this.chartUpBoundXCoor=a,e=0,i="vertical",s=this.svg[this.ChartIndex],n=new DrawXAxis(o,t,e,i,s),n.drawAxis(),t=0,e=0,i="horizontal",this.noofXTips=this.instance.productTypes.length,r=new DrawYAxis(o,t,e,i,s),r.drawAxis(),r.drawYAxis()};var heightEachChart=0,widthEachChart=0;CrossTab.prototype.addHeader=function(){var t,a=document.getElementById("heading");document.body.removeChild(a);var e,i,s,n,r,o,h,l,c,d,p,u,f=new PlotGraph,e=f.createSVG(window.innerWidth,30),m=jsonData.y_axis_map.length;this.sepSVG=e,i="Product Type",s="Product",n=0,r=12;var g=.06*widthEachChart;o="addedText",t={svg:e,fontSize:g,className:o},f.addText(n,r,i,t),n=Math.floor(window.innerWidth/(m+2)),f.addText(n/2,r,s,t);for(var w=0;w<m;w++){h=n*(w+1),l=n*(w+1),c=0,d=30;var C="stroke:rgb(237, 237, 237);stroke-width:1;";f.drawLine(e,h,c,l,d,C),p=jsonData.y_axis_map[w],u=h+.3*n,f.addText(u,r,p,t)}u=n*(w+1),f.drawLine(e,u,c,u,d,C)},CrossTab.prototype.addFooter=function(){var t,a,e,i,s,n,r,o,h,l,c,d,p=new PlotGraph,u=jsonData.y_axis_map.length,f=p.createSVG(window.innerWidth,30);for(this.sepSVG=f,t=widthEachChart,d="stroke:rgb(237, 237, 237);stroke-width:1;",l="drawLineend",p.drawLine(f,widthEachChart,0,widthEachChart*(jsonData.y_axis_map.length+1),0,d,l),c={svg:f,className:"addedText"},o=0;o<u;o++){for(a=t*(o+1),e=t*(o+1),i=0,s=30,d="stroke:rgb(237, 237, 237);stroke-width:1;",p.drawLine(f,a,i,e,s,d),h=0;h<noOfYTips;h++){var m=widthEachChart/noOfYTips;n=a+m*(h+1),p.drawLine(f,n,0,n,4,d),0===h?p.addText(a+m*h,16,"0K",c):h!=noOfYTips&&(r=maximum/noOfYTips*h/1e3,n=a+m*h-10,p.addText(n,16,r+"K",c))}n=a+.3*t,p.addText(n,28,jsonData.xAxisLabel,c)}a=t*(o+1),e=t*(o+1),p.addText(n,28,jsonData.xAxisLabel,c)},CrossTab.prototype.setColumnChartAttr=function(){},CrossTab.prototype.initiateDraw=function(){var t,a,e,i,s,n,r,o,h,l,c=this.instance,d=new PlotGraph,p=jsonData.y_axis_map.length;for(heightEachChart=(window.innerHeight-100)/this.productLen,widthEachChart=Math.floor(window.innerWidth/(p+2)),t=d.createSVG(widthEachChart,heightEachChart),this.sepSVG=t,a=c.model,o={svg:t,className:"addedText"},d.addText(0,12,a,o),e=c.productTypes.length,n=0;n<e;n++)i=widthEachChart/2,s=12+n*heightEachChart/(e+1),d.addText(i,s,c.productTypes[n],o);var u="stroke:rgb(237, 237, 237);stroke-width:1;";for(d.drawLine(t,0,0,widthEachChart,0,u),n=0;n<p;n++)this.ChartIndex=n,this.svg[n]=d.createSVG(widthEachChart,heightEachChart),this.drawChartOutline(),this.setColumnChartAttr(),h=c.productIns[this.ChartIndex].sos,l=c.productIns[this.ChartIndex].sop,this.plotColumnChart(h,this.svg[n],l,e);r="drawLine",t=this.svg[this.ChartIndex],d.drawLine(t,widthEachChart,0,widthEachChart,heightEachChart,u,r)},ColumnChart.prototype.initiateDraw=function(){var t=this.instance,a="plotColumnBound",e=new ChartFunc(t),i=e.drawBoundRectangle(a);t.chartType="column",this.plotColumnChart(),this.selectChartListener(i)},ColumnChart.prototype.plotColumnChart=function(){var t,a,e,i,s,n,r,o,h,l,c,d,p,u=this.instance,f=new PlotGraph(u),m=u.minTipValue,g=u.maxTipValue,w=u.upLimitYAxis,C=u.lowLimitYAxis,x=jsonData.data.length,y=jsonData.scaleColChartFactor,v=u.noofXTips,b=u.lowLimitXAxis,D=u.lowLimitYAxis,A=u.svg;for(a=0;a<x;a++)if(i=u.storeValue[a],"undefined"!=typeof i){d=y/100,t=new ChartFunc(u),e=t.calculateMappingPoint(i,m,g,w,C),e<2&&(e=2),u.storeAncorPointsY[a]=e,s=b+widthEachChart/v*a,storeAncorPointsX[a]=Math.floor(s),n=s-widthEachChart*d,r=D,h=r-e,o=widthEachChart*d*2;var T="fill:rgb(30, 122, 205);stroke-width:3;stroke:rgb(30, 122, 205)";c="plotColumnGraph",p={svg:A,className:c,style:T},l=f.drawRectangle(n,e,h,o,p),this.columnChartListener(l,c),u.lastPlottedPointX=s,u.lastPlottedPointY=e}},ColumnChart.prototype.columnChartListener=function(t,a){var e=this.instance;t.addEventListener("mousemove",entercoordinates.bind(e,a)),t.addEventListener("syncCrossHair",columnTrigger),t.addEventListener("mouseout",removeToolTip),e.toolTipTextIns=document.createElementNS("http://www.w3.org/2000/svg","text"),e.toolTipBoxIns=document.createElementNS("http://www.w3.org/2000/svg","rect")},ColumnChart.prototype.selectChartListener=function(t){var a=this.instance,e=a;a.selectRectIns=document.createElementNS("http://www.w3.org/2000/svg","rect"),a.svg.appendChild(a.selectRectIns),t.addEventListener("mousedown",instantiateDragCol.bind(e)),t.addEventListener("mousemove",dragColRect.bind(e)),t.addEventListener("mouseup",releaseColRect.bind(e))},ChartFunc.prototype.drawBoundRectangle=function(t){var a,e,i,s,n=this.instance,r=n.chartLowBoundXCoor,o=n.chartUpBoundXCoor,h=n.lowLimitYAxis,l=n.upLimitYAxis,c=new PlotGraph(n),d="stroke:rgb(237, 237, 237);stroke-width:1;fill:transparent";return a=o-r,
e=h-l,s={svg:n.svg,className:t,style:d},i=c.drawRectangle(r,l,e,a,s)},ChartFunc.prototype.calculateMappingPoint=function(t,a,e,i,s){return"CrossTab"==jsonData.chartType?(t-a)/(e-a)*(s-i):s-(t-a)/(e-a)*(s-i)},GenColor.prototype.genColor=function(t){var a,e;t>0?(a=jsonData.minProfitColor,e=jsonData.maxProfitColor):(a=jsonData.minLossColor,e=jsonData.maxLossColor,t*=-1),e=e.slice(1,e.length),a=a.slice(1,a.length);var i=function(t){return t=t.toString(16),1==t.length?"0"+t:t},s=Math.ceil(parseInt(a.substring(0,2),16)*t+parseInt(e.substring(0,2),16)*(1-t)),n=Math.ceil(parseInt(a.substring(2,4),16)*t+parseInt(e.substring(2,4),16)*(1-t)),r=Math.ceil(parseInt(a.substring(4,6),16)*t+parseInt(e.substring(4,6),16)*(1-t)),o=i(s)+i(n)+i(r);return"#"+o},PlotColumnBar.prototype.plotColumnChart=function(t,a,e,i){var s,n,r,o,h,l,c,d,p,u,f,m,g,w,C,x,y,v,b=(this.instance,new ChartFunc),D=new GenColor,A=new PlotGraph,T=jsonData.scaleColChartFactor;for(n=0;n<i;n++)if(r=t[n],"undefined"!=typeof r){s=T/100,o=0,h=maximum,l=0,c=widthEachChart,d=b.calculateMappingPoint(r,o,h,l,c),d<2&&(d=2),"true"==jsonData.cmpArr&&"undefined"!=typeof e&&(p=e[n],u=p/r,f=D.genColor(u)),m=0,g=heightEachChart/i*n,w=heightEachChart*s*2,C=d;var j="stroke-width:3;stroke:rgb(30, 122, 205)";y="plotColumnGraph",v={svg:a,className:y,style:j,styleColor:f},x=A.drawRectangle(m,g,w,C,v)}},CrossHair.prototype.drawCrossHair=function(){var t=this.instance,a=new PlotGraph(t),e="drawCrossHairLines",i=t.lowLimitXAxis,s=t.lowLimitYAxis,n=t.upLimitYAxis,r="stroke:rgb(255, 0 , 0);stroke-width:1;",o="3, 2",h="hidden",l=t.svg;a.drawLine(l,i,s,i,n,r,e,h,o)},LineChart.prototype.initiateDraw=function(){var t=this.instance,a="lineBound",e=new ChartFunc(t),i=(e.drawBoundRectangle(a),new CrossHair(t));t.chartType="line",this.plotLineChart(),this.drawDivRectangle(),i.drawCrossHair()},LineChart.prototype.plotLineChart=function(){var t,a,e,i,s,n,r=this.instance,o=new PlotGraph(r),h=0,l=new ChartFunc(r),c=r.minTipValue,d=r.maxTipValue,p=r.upLimitYAxis,u=r.lowLimitYAxis,f=r.lowLimitXAxis,m=r.lastPlottedPointX,g=r.lastPlottedPointY,w=r.noofXTips,C=r.svg;for(a=jsonData.data.length,t=0;t<a;t++)if(e=r.storeValue[t],"undefined"!=typeof e){if(i=l.calculateMappingPoint(e,c,d,p,u),r.storeAncorPointsY[t]=i,s=f+widthEachChart/w*t,storeAncorPointsX[t]=Math.floor(s),0!==h){var x="stroke:rgb(29, 121, 204);stroke-width:6";n="plotGraph",o.drawLine(C,m,g,s,i,x,n),n="ancorTipCicle",o.plotTipCirle(m,g)}m=s,g=i,r.lastPlottedPointX=s,r.lastPlottedPointY=i,h=1}o.plotTipCirle(s,i)},LineChart.prototype.drawDivRectangle=function(){var t=this.instance,a=new PlotGraph(t),e=t.lowLimitXAxis,i=t.upLimitYAxis,s=t.lowLimitYAxis-t.upLimitYAxis,n=t.upLimitXAxis-t.lowLimitXAxis,r="svgDivs",o="fill:transparent",h=t.svg,l=t,c={svg:h,className:r,style:o},d=a.drawRectangle(e,i,s,n,c);d.addEventListener("mousemove",entercoordinates.bind(t,r)),d.addEventListener("syncCrossHair",showCoords,!1),d.addEventListener("syncCrossHair",displayCrossHair,!1),d.addEventListener("mouseleave",clearcoor,!1),d.addEventListener("mouseleave",removeCrossHair,!1),t.toolTipTextIns=document.createElementNS("http://www.w3.org/2000/svg","text"),t.toolTipBoxIns=document.createElementNS("http://www.w3.org/2000/svg","rect"),t.selectRectIns=document.createElementNS("http://www.w3.org/2000/svg","rect"),h.appendChild(t.selectRectIns),d.addEventListener("mousedown",instantiateDragLine.bind(l)),d.addEventListener("mousemove",dragLineRect.bind(l)),d.addEventListener("mouseup",releaseLineRect.bind(l))};